# Телеграмм бот для генерации контекстуальных стикеров

## Задача
Разработать бота для генерации контекстуальных стикеров

## Интерфейс пользователя
Бот находится в чате и считывает текстовое окно (далее - контекст), сохраняя последние 500 символов(~100 слов) в базу данных


## Архитектура решения
Контекст сообщений при вызове командой бота подается на вход языковой модели, которая генерирует из диалога связный контекстуальный промпт. Далее этот промпт подается на вход диффузионной модели, на выходе которой уже и получаем нашу картинку - стикер

## Парсинг
Функционал для парсинга сообщений из чатов с использованием библиотеки Telethon: извлекает сообщения из чатов пользователя и сохраняет их в формате контекст - путь до соответствующего стикера. Одной из ключевых особенностей решения является возможность гибкого и адаптивного парсинга сообщений

## Создание датасета
Для генерации описаний с спарсенным стикерам использовалась модель microsoft/Florence-2-base-ft. Она позволяет генерировать длинные и полные описания. Сохраняем датасет в виде пар context - caption

## Обучение
С помощью библиотек unsloth и trl дообучили на собранном датасете Qwen 2.5 7B на задачу генерации из контекстного окна (на русском) промпта (на английском)
[Обученная модель](https://huggingface.co/Eka-Korn/Qwen-2.5_SFT_v3)

## Результат
![image](https://github.com/user-attachments/assets/f2060d7c-2433-4401-accf-b3b44ffea5e0)

## Содержание репозитория:
---:
